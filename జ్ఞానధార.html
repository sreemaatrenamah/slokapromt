<!DOCTYPE html>
<html lang="te">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=NTR&display=swap" rel="stylesheet">
    <title>జ్ఞానధార! 2026</title>
    <style>
        :root {
            --bg-color: #000000;
            --font-color: #ffffff;
            --fluid-font: clamp(28px, 7vw + 1rem, 52px);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body { 
            font-family: 'NTR', sans-serif; 
            background: #000; 
            color: #fff; 
            overflow: hidden; 
            height: 100vh; 
            display: flex; 
        }

        /* Sidebar Logic */
        .sidebar {
            width: 350px; background: #1a1a1a; padding: 20px;
            display: flex; flex-direction: column; border-right: 1px solid #333; z-index: 100;
            transition: opacity 0.3s ease;
        }

        body.rolling .sidebar {
            display: none;
        }

        @media (max-width: 768px) {
            body { flex-direction: column; }
            .sidebar { width: 100%; height: auto; border-right: none; border-bottom: 1px solid #333; }
        }

        h2 { color: #1a73e8; margin-bottom: 15px; font-size: 20px; font-family: sans-serif; }
        
        textarea { 
            flex-grow: 1; width: 100%; padding: 12px; background: #222; 
            color: #ddd; border: 1px solid #444; border-radius: 8px; 
            font-size: 16px; resize: none; margin-bottom: 15px;
            font-family: 'NTR', sans-serif;
        }

        .controls { display: flex; flex-direction: column; gap: 10px; }
        .config-box { background: #333; padding: 12px; border-radius: 8px; display: flex; flex-direction: column; gap: 10px; }
        .color-row { display: flex; align-items: center; justify-content: space-between; font-size: 14px; }
        
        button { padding: 15px; font-weight: 600; border: none; border-radius: 8px; cursor: pointer; width: 100%; }
        #startBtn { background: #34a853; color: white; }
        
        /* Stop Button with Auto-Hide Transition */
        #stopBtn { 
            background: rgba(234, 67, 53, 0.6); 
            color: white; 
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: auto;
            padding: 10px 30px;
            z-index: 200;
            border: 1px solid rgba(255,255,255,0.2);
            transition: opacity 0.5s ease, visibility 0.5s;
            opacity: 1;
            visibility: visible;
        }

        /* Class to hide the button during inactivity */
        .hidden-ui {
            opacity: 0 !important;
            visibility: hidden !important;
        }

        .prompter-window {
            flex-grow: 1; height: 100vh; overflow: hidden; position: relative;
            background-color: var(--bg-color);
        }

        #scrollContent {
            position: absolute; top: 100%; left: 0; right: 0;
            padding: 0 8%; text-align: center; color: var(--font-color);
        }

        .line {
            font-family: 'NTR', sans-serif !important; 
            font-size: var(--fluid-font);
            line-height: 1.7;
            margin-bottom: 20px;
            word-wrap: break-word;
        }

        .overlay {
            position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            pointer-events: none; z-index: 10;
            background: linear-gradient(to bottom, 
                var(--bg-color) 0%, transparent 15%, 
                transparent 85%, var(--bg-color) 100%);
        }

        #countdown {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            font-size: 80px; font-weight: bold; color: #34a853; z-index: 150;
            display: none;
        }
    </style>
</head>
<body onmousemove="showUI()" ontouchstart="showUI()">

<div id="countdown"></div>

<div class="sidebar">
    <h2>Settings</h2>
    <textarea id="textInput">
సరస్వతీ నమస్తుభ్యం వరదే కామరూపిణి |
విద్యారంభం కరిష్యామి సిద్ధిర్భవతు మే సదా ||
    </textarea>
    
    <div class="controls">
        <div class="config-box">
            <label style="font-size: 14px;">Scroll Speed</label>
            <input type="range" id="speedControl" min="1" max="20" value="5">
        </div>
        <div class="config-box">
            <div class="color-row">
                <label>Background</label>
                <input type="color" id="bgColorPicker" value="#000000">
            </div>
            <div class="color-row">
                <label>Font Color</label>
                <input type="color" id="fontColorPicker" value="#ffffff">
            </div>
        </div>
        <button id="startBtn">Start Rolling</button>
    </div>
</div>

<button id="stopBtn" style="display:none;">Reset / Show Settings</button>

<div class="prompter-window">
    <div class="overlay"></div>
    <div id="scrollContent"></div>
</div>

<script>
    const textInput = document.getElementById('textInput');
    const scrollContent = document.getElementById('scrollContent');
    const startBtn = document.getElementById('startBtn');
    const stopBtn = document.getElementById('stopBtn');
    const speedControl = document.getElementById('speedControl');
    const bgColorPicker = document.getElementById('bgColorPicker');
    const fontColorPicker = document.getElementById('fontColorPicker');
    const countdownEl = document.getElementById('countdown');
    const root = document.documentElement;

    let animationFrame = null;
    let currentY = 0;
    let isScrolling = false;
    let idleTimer;

    bgColorPicker.addEventListener('input', (e) => root.style.setProperty('--bg-color', e.target.value));
    fontColorPicker.addEventListener('input', (e) => root.style.setProperty('--font-color', e.target.value));

    // Logic to show/hide the Reset button based on interaction
    function showUI() {
        if (!document.body.classList.contains('rolling')) return;
        
        stopBtn.classList.remove('hidden-ui');
        clearTimeout(idleTimer);
        
        // Hide again after 2.5 seconds of no movement
        idleTimer = setTimeout(() => {
            if (isScrolling) {
                stopBtn.classList.add('hidden-ui');
            }
        }, 25);
    }

    function initText() {
        const lines = textInput.value.split('\n');
        scrollContent.innerHTML = lines.map(line => `
            <div class="line">${line.trim() === "" ? "&nbsp;" : line}</div>
        `).join('');
        currentY = window.innerHeight;
        scrollContent.style.top = currentY + 'px';
    }

    function step() {
        if (!isScrolling) return;
        const speed = parseFloat(speedControl.value) * 0.4;
        currentY -= speed;
        scrollContent.style.top = currentY + 'px';

        const contentHeight = scrollContent.offsetHeight;
        const middleOfScreen = window.innerHeight / 2;

        if (currentY + contentHeight <= middleOfScreen) {
            currentY = middleOfScreen - contentHeight;
            scrollContent.style.top = currentY + 'px';
            isScrolling = false;
            stopBtn.classList.remove('hidden-ui'); // Always show button when finished
        } else {
            animationFrame = requestAnimationFrame(step);
        }
    }

    function startScrolling() {
        initText();
        document.body.classList.add('rolling');
        startBtn.style.display = 'none';
        stopBtn.style.display = 'block';
        
        let count = 2;
        countdownEl.style.display = 'block';
        countdownEl.innerText = count;
        
        const timer = setInterval(() => {
            count--;
            if (count > 0) {
                countdownEl.innerText = count;
            } else {
                clearInterval(timer);
                countdownEl.style.display = 'none';
                isScrolling = true;
                animationFrame = requestAnimationFrame(step);
                showUI(); // Initialize idle timer
            }
        }, 1000);
    }

    function stopScrolling() {
        isScrolling = false;
        cancelAnimationFrame(animationFrame);
        document.body.classList.remove('rolling');
        stopBtn.classList.remove('hidden-ui');
        startBtn.style.display = 'block';
        stopBtn.style.display = 'none';
        scrollContent.innerHTML = "";
        clearTimeout(idleTimer);
    }

    startBtn.addEventListener('click', startScrolling);
    stopBtn.addEventListener('click', stopScrolling);
</script>
</body>
</html>
